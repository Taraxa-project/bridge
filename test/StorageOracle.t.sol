// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.17;

import {Test, console2} from "forge-std/Test.sol";
import {StorageOracle} from "../src/eth/StorageOracle.sol";
import {RLP} from "../src/lib/RLP.sol";

contract StorageOracleTest {
    function TestStorageOracle() public {
        StorageOracle oracle = new StorageOracle();

        address addr = 0xF3B803a8f4C4Fc3FBE454B6438dc0ED22735f01b;
        bytes32 stateRoot = 0xd08b7805d6ed78d47fb21bf6d9bce81f57c9f435ae0aa2ce66af2c0c6f88858c;
        bytes[] memory accountProof = new bytes[](4);
        accountProof[0] =
            0xf90211a026453a78784cd7b0445642219a7a98307998d22bebf0b0a16b800251ea655a91a0d26327a313e77895d2d3775211b275c3f47f17d34b20961c14e193fd6ab52fb9a041bd0b36773a351dc4fbf105e11ff9cb1a3f08f20e5ecc5e713e926da7f1aa9da0577a40d27fc4ac000e960c9ef2777189b7a32abf7bcbb1d62f41ac6980d004fca0b270256587ad938811f98a5af277579bf5cf844c0ad772d9c7f27be0a732fceca00b653413798f55dcc7cffe0f46948e08ace936ba11e8f9f88ec23073020f9654a03db3f3db03fc62f3c8114d7df790e8f2eea77f8f88e1ed02d0edb10a5ae16a88a0f8506b3044baeebc9bad0fec1936cf85d2514b40a670edbca2aafa0fabb4f09ba012e0e0376e01e6b1cf71611e9c9a44c759351bb0a249bf2bf3891809d3a466e4a0f4cf6d51397829b6b244b07ec8a23f489ca20724104c831ff601395b100a8868a05639884480b7befaf7d93809aaff37310264bfc1155663c7c6bf0b2324f35bdca07ff3d364c14add436f7da92a3997aaad4c8f8b70546aff1f586e44fb115d9547a0f13fcd18e0ca599b78cb705fadedf93670b3a5842868c3cac0edba3ff8d18f92a0a5f09a5ba0ad9b6035ae3bb5a16e17faeb0bc166a3379966e8bfddad193d5b93a0013828537e80e26249baca1ce3c1ce5154577cab2b3c547497312aa34278d24da04ce68f9648e337177a27c9d9e81662560f77f5c764140e36bf2670000fa83d1980;
        accountProof[1] =
            0xf90211a05618e58cf1e8789105df87158caa1a95c64c576c237bee9b19e8c32680240a1fa024b04450bf3796c1d7bc1bc99d04d131ab71b3048b4519d3e7e9d2c41748bc6ca0c2a749d8e597da9de557e92ace2e2f25a94c7ad1daeb453ccdc7a87129980d01a049d79df26b3fe3e94cf6431a956ee4c88f580a7aa36b785521c3de94c97e616da054c6b0a01b95b50334f56b9604ebdfd205f1e14de33959b36ba8188be737458da000eca06b5dfc894e00dadffb6080653470fb9d16156b93156d3ae4eacfcdf614a0166dab38a74f7e2a535ab6e6809d493712734729db54e00b39d42b41502877d5a0ba34c961f09aa5dd3cf4e931663d581177b2094f528d2b69be22b5a75fa632c3a00b242819e5f98aee30a4ae6a266c2c1d91f9476823e7fddb59d3effb62ddc728a0e278f647e68bc2c714c3418f437db96ff68091968f539ae5143fc8e3b425e80aa086c33892d083609613f821a386bf56c930bcc9e7b6fc89ac8cd59615c3a773d7a0a1c4b90c75a30e872b1e91251112f49ad645d39efeddc7b5cde7de8bac1c3996a03e716f1df3754b423694210fb694d678202b6cef689534013e8a433d5b52f559a08ece0ea14a75a67181b048773a907e06b7f5d1a9ccafbb99834d1b1603deaf39a060e2e7ad38c8dd0356e6859abcc45c3001291d6b8711c0fdd446484efaef350fa047cb3774db3f4807f7598c0d0f17d599fe8929dc5c56376a4702271e9b0b63ec80;
        accountProof[2] =
            0xf901118080a0bc767b69835e5bb56ee66bd05ceba1e43c516bcb5a057bd6da36ad40fd901d388080a002de1af99b9df35c363a169f5c4306e90ad18eaaad6913af144d2c97f44489cda06678d57744672e98237db4a14ab06815ca5709c8feedc8fb56c5590bfdcfbb8fa05c63697b77db4ce52eee9a894ac6b28dd2ca2843ba38cef2279f9e69ae475a25a0ee44821dd8586d6b0d485898d7cfa3b4b6ebfeaa05b5d258cce12019b5b004cc80a0d7c5e20c34329c58d47d0c9265d0be2d1a2402f2aeabd85de3ebc24a65de06da80a08d23b524f6216e5ce6afeb1fdd86e1f875cb54144202a3bbe1b113cf7bba3b5680a07e1c9c72c013387050153b8be74f332f7e7f3c4a285e2ec98b263987ca414d7c8080;
        accountProof[3] =
            0xf8739f303c33674335dc1ea86fbb6d24535156747df0ea4bbaf64673229b71c9c246b851f84f018b18dccf4b5ec48c864971a2a04df80d3781ed3d9ffb324690d9c9e3497b2b50500e1e2eca9aabfc152aa6c136a0d78ff381ad3fb30560cbeedfbd8421422578dd5d407f64e8cc7ddc2587c0855b;

        oracle.processStorageRoot(proof.addr, proof.stateRoot, abi.encodePacked(accountProof));
    }
    //           const TaraRpcProof = {
    //     "accountProof": [
    //       "0xf90211a026453a78784cd7b0445642219a7a98307998d22bebf0b0a16b800251ea655a91a0d26327a313e77895d2d3775211b275c3f47f17d34b20961c14e193fd6ab52fb9a041bd0b36773a351dc4fbf105e11ff9cb1a3f08f20e5ecc5e713e926da7f1aa9da0577a40d27fc4ac000e960c9ef2777189b7a32abf7bcbb1d62f41ac6980d004fca0b270256587ad938811f98a5af277579bf5cf844c0ad772d9c7f27be0a732fceca00b653413798f55dcc7cffe0f46948e08ace936ba11e8f9f88ec23073020f9654a03db3f3db03fc62f3c8114d7df790e8f2eea77f8f88e1ed02d0edb10a5ae16a88a0f8506b3044baeebc9bad0fec1936cf85d2514b40a670edbca2aafa0fabb4f09ba012e0e0376e01e6b1cf71611e9c9a44c759351bb0a249bf2bf3891809d3a466e4a0f4cf6d51397829b6b244b07ec8a23f489ca20724104c831ff601395b100a8868a05639884480b7befaf7d93809aaff37310264bfc1155663c7c6bf0b2324f35bdca07ff3d364c14add436f7da92a3997aaad4c8f8b70546aff1f586e44fb115d9547a0f13fcd18e0ca599b78cb705fadedf93670b3a5842868c3cac0edba3ff8d18f92a0a5f09a5ba0ad9b6035ae3bb5a16e17faeb0bc166a3379966e8bfddad193d5b93a0013828537e80e26249baca1ce3c1ce5154577cab2b3c547497312aa34278d24da04ce68f9648e337177a27c9d9e81662560f77f5c764140e36bf2670000fa83d1980",
    //       "0xf90211a05618e58cf1e8789105df87158caa1a95c64c576c237bee9b19e8c32680240a1fa024b04450bf3796c1d7bc1bc99d04d131ab71b3048b4519d3e7e9d2c41748bc6ca0c2a749d8e597da9de557e92ace2e2f25a94c7ad1daeb453ccdc7a87129980d01a049d79df26b3fe3e94cf6431a956ee4c88f580a7aa36b785521c3de94c97e616da054c6b0a01b95b50334f56b9604ebdfd205f1e14de33959b36ba8188be737458da000eca06b5dfc894e00dadffb6080653470fb9d16156b93156d3ae4eacfcdf614a0166dab38a74f7e2a535ab6e6809d493712734729db54e00b39d42b41502877d5a0ba34c961f09aa5dd3cf4e931663d581177b2094f528d2b69be22b5a75fa632c3a00b242819e5f98aee30a4ae6a266c2c1d91f9476823e7fddb59d3effb62ddc728a0e278f647e68bc2c714c3418f437db96ff68091968f539ae5143fc8e3b425e80aa086c33892d083609613f821a386bf56c930bcc9e7b6fc89ac8cd59615c3a773d7a0a1c4b90c75a30e872b1e91251112f49ad645d39efeddc7b5cde7de8bac1c3996a03e716f1df3754b423694210fb694d678202b6cef689534013e8a433d5b52f559a08ece0ea14a75a67181b048773a907e06b7f5d1a9ccafbb99834d1b1603deaf39a060e2e7ad38c8dd0356e6859abcc45c3001291d6b8711c0fdd446484efaef350fa047cb3774db3f4807f7598c0d0f17d599fe8929dc5c56376a4702271e9b0b63ec80",
    //       "0xf901118080a0bc767b69835e5bb56ee66bd05ceba1e43c516bcb5a057bd6da36ad40fd901d388080a002de1af99b9df35c363a169f5c4306e90ad18eaaad6913af144d2c97f44489cda06678d57744672e98237db4a14ab06815ca5709c8feedc8fb56c5590bfdcfbb8fa05c63697b77db4ce52eee9a894ac6b28dd2ca2843ba38cef2279f9e69ae475a25a0ee44821dd8586d6b0d485898d7cfa3b4b6ebfeaa05b5d258cce12019b5b004cc80a0d7c5e20c34329c58d47d0c9265d0be2d1a2402f2aeabd85de3ebc24a65de06da80a08d23b524f6216e5ce6afeb1fdd86e1f875cb54144202a3bbe1b113cf7bba3b5680a07e1c9c72c013387050153b8be74f332f7e7f3c4a285e2ec98b263987ca414d7c8080",
    //       "0xf8739f303c33674335dc1ea86fbb6d24535156747df0ea4bbaf64673229b71c9c246b851f84f018b18dccf4b5ec48c864971a2a04df80d3781ed3d9ffb324690d9c9e3497b2b50500e1e2eca9aabfc152aa6c136a0d78ff381ad3fb30560cbeedfbd8421422578dd5d407f64e8cc7ddc2587c0855b"
    //     ],
    //     "address": "0xf3b803a8f4c4fc3fbe454b6438dc0ed22735f01b",
    //     "balance": "0x18dccf4b5ec48c864971a2",
    //     "codeHash": "0xd78ff381ad3fb30560cbeedfbd8421422578dd5d407f64e8cc7ddc2587c0855b",
    //     "nonce": "0x1",
    //     "storageHash": "0x4df80d3781ed3d9ffb324690d9c9e3497b2b50500e1e2eca9aabfc152aa6c136",
    //     "storageProof": [
    //       {
    //         "key": "0x0000000000000000000000000000000000000000000000000000000000000000",
    //         "proof": [
    //           "0xf90211a081be22290a6d1d35d9ee02bfc7810e9a097550b2b9b2628a37ccf8d4dd4d120fa070ea2ab5bcf00da04795e11a5bec04fe98251d9029882f74fb6ca4574c36b0e5a0b77fb4e391134b4f0bde2b107eaa3b6798e735e8bed83dcc185145378f133b0ba0ee31b6015bdf2bd4c6dd0003339db43ee96bc2adfb653c1d6a5039600777d2b0a0ea0d0db594c7568ff4d49bd3250ede0a613f0f099efa974a102abe167229e501a05560ed54ca02b56fcf20b93ae9642254d457bda2f7752c58344d355aba064418a0cf774ccea9b5c92698486bb71638eb5420fdc0a20a40623e7fba185980734055a0b941d73ad1f78059bf2befefc3a0276d9ccd1600e1f432c0af0cc8995dcd3939a037a37855b0e4d5eeef82873aa6e8a811acc3ea8e9cf349c23f87fcd53813f58da0e63d2a14936488345beb1f3eaa4fa561a37130488d8473bcbb7773b9ca2f2353a061cff155a2179c0e280a0f85dfa1f271a3f257d595182846fb2083f0cb25a779a01d1efe318f928cb1cb596865d54e85955edcb2079c7c3a436a4ddbcbd593e9f1a0df396118c778e14b41e9268530fd3fafb3895ba501a0c262bb50f3179455afb7a0199256f575e3bba3c78cd22e1a693484a1cf97124b5cd3a1d62b53bc9f784b3fa0aef6bc743b72a16513de0765b8a9742419aa2466592beb6ff0f3fc17893e7442a0a69b3e4a61fdebb0c24426e596b4df04a7c4257fae77a6ced8962716079c327480",
    //           "0xf9017180a030ea510dfb865271e7cac6c652386754271b995dd0df30c4b27027ffa969b442a04e11d06eb99fcb857b1f9c893273cc2514f69ef452c75e23db68770d32aae922a0ebab1e037cd025675ba1fa3205283b1d0f4c48a82e93c44071ebd2716036130ca05705cd790dd71c5fce956ce49efd89c1682c5e0f8ca99492c111f13bc570340780a021418e1c9994df0b32dce64e0fb09efb6c2b55aa7b690fd802d7f3b47dafd984a026cb2141437ea2c8538708fd4305514ba4f901eec07a069478a239b2365fedfda00cb5d51955d6e97380d00d689bdc81caa1af45cbed33b6fbeb73041d1d5f9db4a0dd390f6b5603e236f17825c7f570febf1be1d9a017be7b12864948326bec6973a09560850239b2da7f7e04686a01d0c2540775a2da25466fb14e6f59777a2031378080a01204ec2a2fbd3cd7d0fb491117351d708f505ecbe052db1423d7993348e1ba4fa0b8a53550c23eb99ab681b757563f099811c51111a5524ebb2532a500205bb3778080",
    //           "0xf851a0ea4bb646ae0ce80d57fc9cc39b837eadee14c48215b6a52be3224c3222c6bd8f8080808080808080808080808080a08e1719d6b6883ba085f0a1e39816b83ea836a148b43a12de8cab7f20bb249f2e80",
    //           "0xf69f3decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e563959472265301fc9c95c099d334410d7fc6748d85fd61"
    //         ],
    //         "value": "0x72265301fc9c95c099d334410d7fc6748d85fd61"
    //       }
    //     ],
    //     "stateRoot": "0xd08b7805d6ed78d47fb21bf6d9bce81f57c9f435ae0aa2ce66af2c0c6f88858c"
    //   }
    // }
}
